{
  "summary_begin_time": 1689577200,
  "summary_end_time": 1689579000,
  "digest_text": "select `floor` ( `unix_timestamp` ( min ( `summary_begin_time` ) ) ) as `agg_begin_time` , `floor` ( `unix_timestamp` ( max ( `summary_end_time` ) ) ) as `agg_end_time` , `any_value` ( `digest_text` ) as `agg_digest_text` , `any_value` ( digest ) as `agg_digest` , sum ( `exec_count` ) as `agg_exec_count` , sum ( `sum_latency` ) as `agg_sum_latency` , max ( `max_latency` ) as `agg_max_latency` , min ( `min_latency` ) as `agg_min_latency` , cast ( sum ( `exec_count` * `avg_latency` ) / sum ( `exec_count` ) as signed ) as `agg_avg_latency` , `any_value` ( `schema_name` ) as `agg_schema_name` , count ( distinct `plan_digest` ) as `agg_plan_count` from `information_schema` . `cluster_statements_summary_history` where `summary_begin_time` \u003c= `from_unixtime` ( ? ) and `summary_end_time` \u003e= `from_unixtime` ( ? ) group by `schema_name` , digest order by `agg_sum_latency` desc",
  "digest": "96d644ebd46e6b7ef02747cf8643c952a7829974675cde3ec1c715e438e593eb",
  "exec_count": 3,
  "stmt_type": "Select",
  "sum_errors": 0,
  "sum_warnings": 0,
  "sum_latency": 19590614,
  "max_latency": 6921084,
  "min_latency": 6264378,
  "avg_latency": 6530204,
  "avg_parse_latency": 0,
  "max_parse_latency": 0,
  "avg_compile_latency": 2308761,
  "max_compile_latency": 2783390,
  "sum_cop_task_num": 3,
  "avg_cop_process_time": 0,
  "max_cop_process_time": 0,
  "avg_cop_wait_time": 0,
  "max_cop_wait_time": 0,
  "avg_process_time": 0,
  "max_process_time": 0,
  "avg_wait_time": 0,
  "max_wait_time": 0,
  "avg_backoff_time": 0,
  "max_backoff_time": 0,
  "avg_total_keys": 0,
  "max_total_keys": 0,
  "avg_processed_keys": 0,
  "max_processed_keys": 0,
  "avg_prewrite_time": 0,
  "max_prewrite_time": 0,
  "avg_commit_time": 0,
  "max_commit_time": 0,
  "avg_get_commit_ts_time": 0,
  "max_get_commit_ts_time": 0,
  "avg_commit_backoff_time": 0,
  "max_commit_backoff_time": 0,
  "avg_resolve_lock_time": 0,
  "max_resolve_lock_time": 0,
  "avg_local_latch_wait_time": 0,
  "max_local_latch_wait_time": 0,
  "avg_write_keys": 0,
  "max_write_keys": 0,
  "avg_write_size": 0,
  "max_write_size": 0,
  "avg_prewrite_regions": 0,
  "max_prewrite_regions": 0,
  "avg_txn_retry": 0,
  "max_txn_retry": 0,
  "sum_backoff_times": 0,
  "avg_mem": 97875,
  "max_mem": 99224,
  "avg_disk": 0,
  "max_disk": 0,
  "avg_affected_rows": 0,
  "first_seen": 1689578314,
  "last_seen": 1689578315,
  "sample_user": "root",
  "query_sample_text": "SELECT FLOOR(UNIX_TIMESTAMP(MIN(summary_begin_time))) AS agg_begin_time, FLOOR(UNIX_TIMESTAMP(MAX(summary_end_time))) AS agg_end_time, ANY_VALUE(digest_text) AS agg_digest_text, ANY_VALUE(digest) AS agg_digest, SUM(exec_count) AS agg_exec_count, SUM(sum_latency) AS agg_sum_latency, MAX(max_latency) AS agg_max_latency, MIN(min_latency) AS agg_min_latency, CAST(SUM(exec_count * avg_latency) / SUM(exec_count) AS SIGNED) AS agg_avg_latency, ANY_VALUE(schema_name) AS agg_schema_name, COUNT(DISTINCT plan_digest) AS agg_plan_count FROM `INFORMATION_SCHEMA`.`CLUSTER_STATEMENTS_SUMMARY_HISTORY` WHERE summary_begin_time \u003c= FROM_UNIXTIME(?) AND summary_end_time \u003e= FROM_UNIXTIME(?) GROUP BY schema_name, digest ORDER BY agg_sum_latency DESC [arguments: (1689578315, 1689576514)]",
  "prev_sample_text": "",
  "schema_name": "",
  "table_names": "information_schema.cluster_statements_summary_history",
  "index_names": "",
  "plan_count": 1,
  "plan": "\tid                          \ttask     \testRows\toperator info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \tactRows\texecution info                                                                                                                                           \tmemory \tdisk\n\tSort_6                      \troot     \t886.22 \tColumn#101:desc                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \t6      \ttime:2.46ms, loops:2                                                                                                                                     \t7.63 KB\t0 Bytes\n\t└─Projection_8              \troot     \t886.22 \tfloor(unix_timestamp(Column#98))-\u003eColumn#106, floor(unix_timestamp(Column#99))-\u003eColumn#107, any_value(information_schema.cluster_statements_summary_history.digest_text)-\u003eColumn#108, any_value(information_schema.cluster_statements_summary_history.digest)-\u003eColumn#109, Column#100, Column#101, Column#102, Column#103, cast(div(Column#104, Column#100), bigint(22) BINARY)-\u003eColumn#110, any_value(information_schema.cluster_statements_summary_history.schema_name)-\u003eColumn#111, Column#105                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \t6      \ttime:2.37ms, loops:2, Concurrency:OFF                                                                                                                    \t8.93 KB\tN/A\n\t  └─HashAgg_9               \troot     \t886.22 \tgroup by:Column#129, Column#130, funcs:min(Column#118)-\u003eColumn#98, funcs:max(Column#119)-\u003eColumn#99, funcs:sum(Column#120)-\u003eColumn#100, funcs:sum(Column#121)-\u003eColumn#101, funcs:max(Column#122)-\u003eColumn#102, funcs:min(Column#123)-\u003eColumn#103, funcs:sum(Column#124)-\u003eColumn#104, funcs:count(distinct Column#125)-\u003eColumn#105, funcs:firstrow(Column#126)-\u003einformation_schema.cluster_statements_summary_history.schema_name, funcs:firstrow(Column#127)-\u003einformation_schema.cluster_statements_summary_history.digest, funcs:firstrow(Column#128)-\u003einformation_schema.cluster_statements_summary_history.digest_text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \t6      \ttime:2.31ms, loops:2                                                                                                                                     \t16.4 KB\t0 Bytes\n\t    └─Projection_14         \troot     \t1107.78\tinformation_schema.cluster_statements_summary_history.summary_begin_time, information_schema.cluster_statements_summary_history.summary_end_time, cast(information_schema.cluster_statements_summary_history.exec_count, decimal(20,0) UNSIGNED BINARY)-\u003eColumn#120, cast(information_schema.cluster_statements_summary_history.sum_latency, decimal(20,0) UNSIGNED BINARY)-\u003eColumn#121, information_schema.cluster_statements_summary_history.max_latency, information_schema.cluster_statements_summary_history.min_latency, cast(mul(information_schema.cluster_statements_summary_history.exec_count, information_schema.cluster_statements_summary_history.avg_latency), decimal(20,0) UNSIGNED BINARY)-\u003eColumn#124, information_schema.cluster_statements_summary_history.plan_digest, information_schema.cluster_statements_summary_history.schema_name, information_schema.cluster_statements_summary_history.digest, information_schema.cluster_statements_summary_history.digest_text, information_schema.cluster_statements_summary_history.schema_name, information_schema.cluster_statements_summary_history.digest\t6      \ttime:2.2ms, loops:2, Concurrency:5                                                                                                                       \t73.4 KB\tN/A\n\t      └─TableReader_12      \troot     \t1107.78\tdata:Selection_11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \t6      \ttime:1.98ms, loops:2, cop_task: {num: 1, max: 1.97ms, proc_keys: 0, rpc_num: 1, rpc_time: 1.91ms, copr_cache_hit_ratio: 0.00, max_distsql_concurrency: 1}\t2.17 KB\tN/A\n\t        └─Selection_11      \tcop[tidb]\t1107.78\tge(information_schema.cluster_statements_summary_history.summary_end_time, 2023-07-17 14:48:34), le(information_schema.cluster_statements_summary_history.summary_begin_time, 2023-07-17 15:18:35)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \t0      \t                                                                                                                                                         \tN/A    \tN/A\n\t          └─TableFullScan_10\tcop[tidb]\t10000  \ttable:CLUSTER_STATEMENTS_SUMMARY_HISTORY, keep order:false, stats:pseudo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \t0      \t                                                                                                                                                         \tN/A    \tN/A",
  "plan_digest": "6e0faf2c3194560606f6851736a248307d11fd16038a3f5f1f9decc992e09d71",
  "binary_plan": "{\"discardedDueToTooLong\":false,\"main\":{\"accessObjects\":[],\"actRows\":6,\"children\":[{\"accessObjects\":[],\"actRows\":6,\"children\":[{\"accessObjects\":[],\"actRows\":6,\"children\":[{\"accessObjects\":[],\"actRows\":6,\"children\":[{\"accessObjects\":[],\"actRows\":6,\"children\":[{\"accessObjects\":[],\"actRows\":0,\"children\":[{\"accessObjects\":[{\"scanObject\":{\"database\":\"INFORMATION_SCHEMA\",\"table\":\"CLUSTER_STATEMENTS_SUMMARY_HISTORY\"}}],\"actRows\":0,\"copExecInfo\":{},\"cost\":3387024.734619157,\"diagnosis\":[],\"diskBytes\":\"N/A\",\"duration\":\"0s\",\"estRows\":10000,\"labels\":[],\"memoryBytes\":\"N/A\",\"name\":\"TableFullScan_10\",\"operatorInfo\":\"keep order:false, stats:pseudo\",\"rootBasicExecInfo\":{},\"rootGroupExecInfo\":[],\"storeType\":\"tidb\",\"taskType\":\"cop\"}],\"copExecInfo\":{},\"cost\":4385024.734619157,\"diagnosis\":[\"high_est_error\"],\"diskBytes\":\"N/A\",\"duration\":\"0s\",\"estRows\":1107.777777777778,\"labels\":[],\"memoryBytes\":\"N/A\",\"name\":\"Selection_11\",\"operatorInfo\":\"ge(information_schema.cluster_statements_summary_history.summary_end_time, 2023-07-17 14:48:34), le(information_schema.cluster_statements_summary_history.summary_begin_time, 2023-07-17 15:18:35)\",\"rootBasicExecInfo\":{},\"rootGroupExecInfo\":[],\"storeType\":\"tidb\",\"taskType\":\"cop\"}],\"copExecInfo\":{},\"cost\":385920.0489746105,\"diagnosis\":[],\"diskBytes\":\"N/A\",\"duration\":\"1.98ms\",\"estRows\":1107.777777777778,\"labels\":[],\"memoryBytes\":\"2224\",\"name\":\"TableReader_12\",\"operatorInfo\":\"data:Selection_11\",\"rootBasicExecInfo\":{\"loops\":\"2\",\"time\":\"1.98ms\"},\"rootGroupExecInfo\":[{\"cop_task\":{\"copr_cache_hit_ratio\":\"0.00\",\"max\":\"1.97ms\",\"max_distsql_concurrency\":\"1\",\"num\":\"1\",\"proc_keys\":\"0\",\"rpc_num\":\"1\",\"rpc_time\":\"1.91ms\"}}],\"storeType\":\"tidb\",\"taskType\":\"root\"}],\"copExecInfo\":{},\"cost\":420192.47786349937,\"diagnosis\":[],\"diskBytes\":\"N/A\",\"duration\":\"2.2ms\",\"estRows\":1107.777777777778,\"labels\":[],\"memoryBytes\":\"75200\",\"name\":\"Projection_14\",\"operatorInfo\":\"information_schema.cluster_statements_summary_history.summary_begin_time, information_schema.cluster_statements_summary_history.summary_end_time, cast(information_schema.cluster_statements_summary_history.exec_count, decimal(20,0) UNSIGNED BINARY)-\\u003eColumn#120, cast(information_schema.cluster_statements_summary_history.sum_latency, decimal(20,0) UNSIGNED BINARY)-\\u003eColumn#121, information_schema.cluster_statements_summary_history.max_latency, information_schema.cluster_statements_summary_history.min_latency, cast(mul(information_schema.cluster_statements_summary_history.exec_count, information_schema.cluster_statements_summary_history.avg_latency), decimal(20,0) UNSIGNED BINARY)-\\u003eColumn#124, information_schema.cluster_statements_summary_history.plan_digest, information_schema.cluster_statements_summary_history.schema_name, information_schema.cluster_statements_summary_history.digest, information_schema.cluster_statements_summary_history.digest_text, information_schema.cluster_statements_summary_history.schema_name, information_schema.cluster_statements_summary_history.digest\",\"rootBasicExecInfo\":{\"loops\":\"2\",\"time\":\"2.2ms\"},\"rootGroupExecInfo\":[{\"Concurrency\":\"5\"}],\"storeType\":\"tidb\",\"taskType\":\"root\"}],\"copExecInfo\":{},\"cost\":579159.6458634995,\"diagnosis\":[],\"diskBytes\":\"N/A\",\"duration\":\"2.31ms\",\"estRows\":886.2222222222225,\"labels\":[],\"memoryBytes\":\"16809\",\"name\":\"HashAgg_9\",\"operatorInfo\":\"group by:Column#129, Column#130, funcs:min(Column#118)-\\u003eColumn#98, funcs:max(Column#119)-\\u003eColumn#99, funcs:sum(Column#120)-\\u003eColumn#100, funcs:sum(Column#121)-\\u003eColumn#101, funcs:max(Column#122)-\\u003eColumn#102, funcs:min(Column#123)-\\u003eColumn#103, funcs:sum(Column#124)-\\u003eColumn#104, funcs:count(distinct Column#125)-\\u003eColumn#105, funcs:firstrow(Column#126)-\\u003einformation_schema.cluster_statements_summary_history.schema_name, funcs:firstrow(Column#127)-\\u003einformation_schema.cluster_statements_summary_history.digest, funcs:firstrow(Column#128)-\\u003einformation_schema.cluster_statements_summary_history.digest_text\",\"rootBasicExecInfo\":{\"loops\":\"2\",\"time\":\"2.31ms\"},\"rootGroupExecInfo\":[],\"storeType\":\"tidb\",\"taskType\":\"root\"}],\"copExecInfo\":{},\"cost\":632668.8574190551,\"diagnosis\":[],\"diskBytes\":\"N/A\",\"duration\":\"2.37ms\",\"estRows\":886.2222222222225,\"labels\":[],\"memoryBytes\":\"9140\",\"name\":\"Projection_8\",\"operatorInfo\":\"floor(unix_timestamp(Column#98))-\\u003eColumn#106, floor(unix_timestamp(Column#99))-\\u003eColumn#107, any_value(information_schema.cluster_statements_summary_history.digest_text)-\\u003eColumn#108, any_value(information_schema.cluster_statements_summary_history.digest)-\\u003eColumn#109, Column#100, Column#101, Column#102, Column#103, cast(div(Column#104, Column#100), bigint(22) BINARY)-\\u003eColumn#110, any_value(information_schema.cluster_statements_summary_history.schema_name)-\\u003eColumn#111, Column#105\",\"rootBasicExecInfo\":{\"loops\":\"2\",\"time\":\"2.37ms\"},\"rootGroupExecInfo\":[{\"Concurrency\":\"OFF\"}],\"storeType\":\"tidb\",\"taskType\":\"root\"}],\"copExecInfo\":{},\"cost\":1111049.0271363556,\"diagnosis\":[],\"diskBytes\":\"N/A\",\"duration\":\"2.46ms\",\"estRows\":886.2222222222225,\"labels\":[],\"memoryBytes\":\"7812\",\"name\":\"Sort_6\",\"operatorInfo\":\"Column#101:desc\",\"rootBasicExecInfo\":{\"loops\":\"2\",\"time\":\"2.46ms\"},\"rootGroupExecInfo\":[],\"storeType\":\"tidb\",\"taskType\":\"root\"},\"withRuntimeStats\":true}",
  "plan_hint": "hash_agg(@`sel_1`), use_index(@`sel_1` `information_schema`.`cluster_statements_summary_history` )",
  "max_rocksdb_delete_skipped_count": 0,
  "avg_rocksdb_delete_skipped_count": 0,
  "max_rocksdb_key_skipped_count": 0,
  "avg_rocksdb_key_skipped_count": 0,
  "max_rocksdb_block_cache_hit_count": 0,
  "avg_rocksdb_block_cache_hit_count": 0,
  "max_rocksdb_block_read_count": 0,
  "avg_rocksdb_block_read_count": 0,
  "max_rocksdb_block_read_byte": 0,
  "avg_rocksdb_block_read_byte": 0,
  "related_schemas": "",
  "plan_can_be_bound": false
}
